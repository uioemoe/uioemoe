<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .calculator {
            width: 100%;
            max-width: 400px;
            background-color: #0f3460;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .display-container {
            padding: 30px 25px 20px;
            background-color: rgba(0, 0, 0, 0.3);
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }
        
        .previous-operand {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
            min-height: 27px;
            text-align: right;
            word-wrap: break-word;
            word-break: break-all;
        }
        
        .current-operand {
            color: white;
            font-size: 2.8rem;
            font-weight: 300;
            text-align: right;
            word-wrap: break-word;
            word-break: break-all;
            min-height: 60px;
            margin-top: 5px;
        }
        
        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-gap: 12px;
            padding: 25px;
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        button {
            border: none;
            outline: none;
            cursor: pointer;
            font-size: 1.5rem;
            border-radius: 12px;
            height: 70px;
            background-color: #1e3a5c;
            color: white;
            transition: all 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .operation-btn {
            background-color: #2d4a7c;
            font-size: 1.6rem;
        }
        
        .operation-btn:hover {
            background-color: #3a5a9c;
        }
        
        .equals-btn {
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            color: white;
            font-size: 1.8rem;
            grid-column: span 2;
        }
        
        .equals-btn:hover {
            background: linear-gradient(to right, #ff6b47, #fea05a);
        }
        
        .function-btn {
            background-color: #3d5a80;
            font-size: 1.4rem;
        }
        
        .function-btn:hover {
            background-color: #4a6a9c;
        }
        
        .number-btn {
            background-color: #2d4a7c;
        }
        
        .number-btn:hover {
            background-color: #3a5a9c;
        }
        
        .zero-btn {
            grid-column: span 2;
        }
        
        .decimal-btn {
            font-weight: bold;
        }
        
        .delete-btn i {
            font-size: 1.4rem;
        }
        
        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            padding: 15px 0;
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        @media (max-width: 480px) {
            .calculator {
                max-width: 100%;
                border-radius: 15px;
            }
            
            .buttons-grid {
                grid-gap: 10px;
                padding: 20px;
            }
            
            button {
                height: 65px;
                font-size: 1.3rem;
                border-radius: 10px;
            }
            
            .current-operand {
                font-size: 2.3rem;
            }
        }
        
        @media (max-width: 350px) {
            .buttons-grid {
                grid-gap: 8px;
                padding: 15px;
            }
            
            button {
                height: 60px;
                font-size: 1.2rem;
            }
            
            .current-operand {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="display-container">
            <div class="previous-operand"></div>
            <div class="current-operand">0</div>
        </div>
        
        <div class="buttons-grid">
            <!-- First Row -->
            <button class="function-btn" data-action="clear">AC</button>
            <button class="function-btn" data-action="delete">
                <i class="fas fa-backspace"></i>
            </button>
            <button class="function-btn" data-action="percentage">%</button>
            <button class="operation-btn" data-operation="÷">÷</button>
            
            <!-- Second Row -->
            <button class="number-btn" data-number="7">7</button>
            <button class="number-btn" data-number="8">8</button>
            <button class="number-btn" data-number="9">9</button>
            <button class="operation-btn" data-operation="×">×</button>
            
            <!-- Third Row -->
            <button class="number-btn" data-number="4">4</button>
            <button class="number-btn" data-number="5">5</button>
            <button class="number-btn" data-number="6">6</button>
            <button class="operation-btn" data-operation="-">−</button>
            
            <!-- Fourth Row -->
            <button class="number-btn" data-number="1">1</button>
            <button class="number-btn" data-number="2">2</button>
            <button class="number-btn" data-number="3">3</button>
            <button class="operation-btn" data-operation="+">+</button>
            
            <!-- Fifth Row -->
            <button class="number-btn zero-btn" data-number="0">0</button>
            <button class="number-btn decimal-btn" data-action="decimal">.</button>
            <button class="equals-btn" data-action="equals">=</button>
        </div>
        
        <div class="footer">
            Modern Calculator | Built with HTML, CSS & JavaScript
        </div>
    </div>

    <script>
        // Calculator State
        const calculator = {
            displayValue: '0',
            firstOperand: null,
            waitingForSecondOperand: false,
            operator: null,
            previousOperand: '',
            isResultDisplayed: false
        };

        // DOM Elements
        const currentOperandElement = document.querySelector('.current-operand');
        const previousOperandElement = document.querySelector('.previous-operand');

        // Update the display
        function updateDisplay() {
            currentOperandElement.textContent = calculator.displayValue;
            previousOperandElement.textContent = calculator.previousOperand;
        }

        // Reset calculator to initial state
        function resetCalculator() {
            calculator.displayValue = '0';
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculator.previousOperand = '';
            calculator.isResultDisplayed = false;
            updateDisplay();
        }

        // Delete last entered digit
        function deleteLastDigit() {
            // If it's a result, clear everything
            if (calculator.isResultDisplayed) {
                resetCalculator();
                return;
            }
            
            // If there's only one digit or it's 0, reset to 0
            if (calculator.displayValue.length === 1 || calculator.displayValue === '0') {
                calculator.displayValue = '0';
            } else {
                // Remove last digit
                calculator.displayValue = calculator.displayValue.slice(0, -1);
            }
            
            updateDisplay();
        }

        // Input a number
        function inputNumber(number) {
            const { displayValue, waitingForSecondOperand, isResultDisplayed } = calculator;
            
            // If a result is displayed, reset calculator before inputting new number
            if (isResultDisplayed) {
                calculator.displayValue = number;
                calculator.isResultDisplayed = false;
                calculator.previousOperand = '';
            } else if (waitingForSecondOperand) {
                // If waiting for second operand, replace display with new number
                calculator.displayValue = number;
                calculator.waitingForSecondOperand = false;
            } else {
                // Otherwise, append the number to display
                calculator.displayValue = displayValue === '0' ? number : displayValue + number;
            }
            
            updateDisplay();
        }

        // Input a decimal point
        function inputDecimal() {
            const { displayValue, waitingForSecondOperand, isResultDisplayed } = calculator;
            
            // If a result is displayed, reset calculator before inputting decimal
            if (isResultDisplayed) {
                calculator.displayValue = '0.';
                calculator.isResultDisplayed = false;
                calculator.previousOperand = '';
                updateDisplay();
                return;
            }
            
            // If waiting for second operand, start with "0."
            if (waitingForSecondOperand) {
                calculator.displayValue = '0.';
                calculator.waitingForSecondOperand = false;
                updateDisplay();
                return;
            }
            
            // If the display doesn't already contain a decimal point, add one
            if (!displayValue.includes('.')) {
                calculator.displayValue += '.';
            }
            
            updateDisplay();
        }

        // Handle percentage operation
        function handlePercentage() {
            const currentValue = parseFloat(calculator.displayValue);
            
            // Calculate percentage
            calculator.displayValue = (currentValue / 100).toString();
            calculator.isResultDisplayed = true;
            
            // Update display
            updateDisplay();
        }

        // Handle operator input
        function handleOperation(nextOperator) {
            const { firstOperand, displayValue, operator, waitingForSecondOperand } = calculator;
            const inputValue = parseFloat(displayValue);
            
            // If an operator already exists and we're not waiting for second operand, calculate result
            if (operator && !waitingForSecondOperand) {
                const result = calculate(firstOperand, inputValue, operator);
                
                // Update display with result
                calculator.displayValue = `${parseFloat(result.toFixed(7))}`;
                calculator.firstOperand = result;
                calculator.previousOperand = `${firstOperand} ${operator} ${inputValue} =`;
            } else {
                // Otherwise, just store the input value
                calculator.firstOperand = inputValue;
                calculator.previousOperand = `${inputValue} ${nextOperator}`;
            }
            
            // Set the next operator and wait for second operand
            calculator.waitingForSecondOperand = true;
            calculator.operator = nextOperator;
            calculator.isResultDisplayed = false;
            
            updateDisplay();
        }

        // Perform calculation
        function calculate(firstOperand, secondOperand, operator) {
            switch (operator) {
                case '+':
                    return firstOperand + secondOperand;
                case '-':
                    return firstOperand - secondOperand;
                case '×':
                    return firstOperand * secondOperand;
                case '÷':
                    // Prevent division by zero
                    if (secondOperand === 0) {
                        alert("Cannot divide by zero!");
                        resetCalculator();
                        return 0;
                    }
                    return firstOperand / secondOperand;
                default:
                    return secondOperand;
            }
        }

        // Handle equals button
        function handleEquals() {
            const { firstOperand, displayValue, operator } = calculator;
            const inputValue = parseFloat(displayValue);
            
            // If there's no operator or first operand, do nothing
            if (operator === null || firstOperand === null) {
                return;
            }
            
            // Perform calculation
            const result = calculate(firstOperand, inputValue, operator);
            
            // Update calculator state
            calculator.displayValue = `${parseFloat(result.toFixed(7))}`;
            calculator.previousOperand = `${firstOperand} ${operator} ${inputValue} =`;
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculator.isResultDisplayed = true;
            
            updateDisplay();
        }

        // Add event listeners to buttons
        function setupEventListeners() {
            // Number buttons
            document.querySelectorAll('[data-number]').forEach(button => {
                button.addEventListener('click', () => {
                    inputNumber(button.getAttribute('data-number'));
                });
            });
            
            // Operation buttons
            document.querySelectorAll('[data-operation]').forEach(button => {
                button.addEventListener('click', () => {
                    handleOperation(button.getAttribute('data-operation'));
                });
            });
            
            // Function buttons (AC, delete, percentage, decimal, equals)
            document.querySelector('[data-action="clear"]').addEventListener('click', resetCalculator);
            document.querySelector('[data-action="delete"]').addEventListener('click', deleteLastDigit);
            document.querySelector('[data-action="percentage"]').addEventListener('click', handlePercentage);
            document.querySelector('[data-action="decimal"]').addEventListener('click', inputDecimal);
            document.querySelector('[data-action="equals"]').addEventListener('click', handleEquals);
            
            // Keyboard support
            document.addEventListener('keydown', event => {
                const { key } = event;
                
                // Prevent default behavior for calculator keys
                if (/[\d+\-*/.=]|Enter|Backspace|Delete|Escape/.test(key)) {
                    event.preventDefault();
                }
                
                // Map keyboard keys to calculator functions
                if (key >= '0' && key <= '9') {
                    inputNumber(key);
                } else if (key === '.') {
                    inputDecimal();
                } else if (key === '+' || key === '-') {
                    handleOperation(key);
                } else if (key === '*' || key === 'x' || key === 'X') {
                    handleOperation('×');
                } else if (key === '/') {
                    handleOperation('÷');
                } else if (key === 'Enter' || key === '=') {
                    handleEquals();
                } else if (key === 'Escape' || key === 'Delete') {
                    resetCalculator();
                } else if (key === 'Backspace') {
                    deleteLastDigit();
                } else if (key === '%') {
                    handlePercentage();
                }
            });
        }

        // Initialize calculator
        function initCalculator() {
            updateDisplay();
            setupEventListeners();
        }

        // Start calculator when page loads
        document.addEventListener('DOMContentLoaded', initCalculator);
    </script>
</body>
</html>
